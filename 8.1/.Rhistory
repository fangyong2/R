#最小二乘（OLS）回归法：简单线性回归、多项式回归和多元性回归
#简单线性回归
fit <- lm(weight ~ height,data=women)
summary(fit)
women$weight
fitted(fit)
residuals(fit)
plot(women$height,women$weight,xlab="Height(in inches),ylab="Weight(in pounds)"")
plot(women$height,women$weight,xlab="Height(in inches),ylab="Weight(in pounds)")
plot(women$height,women$weight,xlab="Height(in inches)",ylab="Weight(in pounds)")
abline(fit)
save.image()
savehistory()
q()
history()
plot(women$height,women$weight,xlab="Height(in inches)",ylab="Weight(in pounds)")
#多项式回归
fit2 <- lm(weight ~ height + I(height^2),data=women)
summary(fit2)
plot(women$height,women$weight,xlab="Height (in inches)",ylab="Weight (in lbs)")
line(women$height,fitted(fit2))
library(car)
install.packages("car")
library(car)
scatterplot(weight~height,data=women,spread=FALSE,lty.smooth=2,pch=19,main="Women Age 30-39",xlab="Height (inches)",ylab="Weight (lbs.)")
#检测二变量关系
cor(states)
#多元线性回归
fit <- lm(Murder ~ Population + Illiteracy + Income + Frost, data=states)
states <- as.data.frame(state.x77[,c("Murder","Population","Illiteracy","Income","Frost")])
cor(states)
scatterplot(states,spread=FALSE,lty.smooth=2,main="Scatter Plot Matrix")
scatterplotMatrix(states,spread=FALSE,lty.smooth=2,main="Scatter Plot Matrix")
fit <- lm(Murder ~ Population + Illiteracy + Income + Frost, data=states)
summary(fit)
#有显著交互项的多元线性回归
fit <- lm(mpg ~ hp+wt+hp:wt,data=mtcars)
summary(fit)
 plot(effect(term,mod,xleves),multiline=TRUE)
library("effects")
install.packages("effects")
library("effects")
plot(effect("hp:wt",fit,list=c(wt=c(2.2,3.2,4.2))),multiline=TRUE)
save.image()
savehistory()
q()
