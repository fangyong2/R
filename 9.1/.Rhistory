load("F:\\r\\04\\.RData")
attach(mtcars)
plot(wt,mpg)
abline(mpg~wt)
abline(lm(mpg~wt))
title("Regression of MPG on Weight")
detach(mtcars)
pdf("mygraph.pdf")
attach(mtcars)
plot(wt,mpg)
abline(lm(mpg~wt))
title("Regression of MPG on Weight")
detach(mtcars)
dev.off()
attach(mtcars)
plot(wt,mpg)
hist(wt,mpg)
dose <- c(20,30,40,45,60)
drugA <- c(16,20,27,40,60)
drugB <- c(15,18,25,31,40)
plot(dose,drugA,type="b")
help(plot)
plot(dose,drugA,type="p")
plot(dose,drugA,type="l")
plot(dose,drugA,type="c")
plot(dose,drugA,type="o")
plot(dose,drugA,type="h")
plot(dose,drugA,type="s")
plot(dose,drugA,type="S")
plot(dose,drugA,type="n")
plot(dose,drugA,type="b")
opar <- par(no.readonly=TRUE)
par(lty=2,pch=17)
plot(dose,drugA,type="b")
par(opar)
help(par)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=15,cex=2)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=22,cex=2)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=6,cex=2)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col="red")
color <-c("red","aqua","blue")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color)
color <-c("red","black","blue")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color)
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color,col.axis="green")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color,col.axis="green",col.lab="yellow")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color,col.axis="green",col.lab="yellow",col.main="red")
title("demo title")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color,col.axis="green",col.lab="yellow",col.main="red",fg="grey")
plot(dose,drugA,type="b",lty=3,lwd=3,pch=11,cex=2,col=color,col.axis="green",col.lab="yellow",col.main="red",bg="black")
q()
#单因素方差分析
library(multcomp)
install.packages("multcomp")
library(multcomp)
attach(cholestero)
attach(cholesterol)
table(trt)
aggregate(response,by=list(trt).FUN=mean)
aggregate(response,by=list(trt),FUN=mean)
aggregate(response,by=list(trt),FUN=sd)
fit <- aov(response~trt)
summary(fit)
library(gplots)
install.packages("gplots")
library(gplots)
plotmeans(response~trt,xlab="Treatment",ylab="Response",main="Mean Plot\nwith 95% CI")
#多重比较
#Tukey HSD的成对组间比较
TukeyHSD(fit)
par(las=2)
par(mar=c(5,8,4,2))
plot(TukeyHSD(fit))
par(mar=c(5,4,6,2))
tuk<-glht(fit,linfct=mcp(trt="Tukey"))
plot(cld(tuk,level=.05),col="lightgrey")
#评估检验的假设条件
library(car)
install.packages("car")
library(car)
qqPlot(lm(response~trt,data=cholesterol),simulate=TRUE,main="Q-Q Plot",labels=FALSE)
#方差齐性检验函数
bartlett.test(response~trt,data=cholesterol)
#检测离群点
outlierTest(fit)
单因素协方差分析
#单因素协方差分析
data(litter,package="multcomp")
attach(litter)
table(dose)
fit<-aov(weight~gesttime+dose)
aggregate(weight,by=list(dose),FUN=mean)
table(dose)
aggregate(weight,by=list(dose),FUN=mean)
library(effects)
install.packages("effects")
library(effects)
effect("dose",fit)
data(litter,package="multcomp")
attach(litter)
table(dose)
aggregate(weight,by=list(dose),Fun=mean)
aggregate(weight,by=list(dose),FUN=mean)
#用户定义的对照的多重比较
library(multcomp)
contrast<-rbind("no drug vs.drug" = c(3,-1,-1,-1))
summary(glht(fit,linfct=mcp(dose=contrast)))
#评估检验的假设条件
library(multcomp)
fit2<-aov(weight~gestime*dose,data=litter)
fit2<-aov(weight~gesttime*dose,data=litter)
summary(fit2)
#结果可视化
library(HH)
install.packages("HH")
library(HH)
ancova(weight~gesttime+dose,data=litter)
#双因素方差分析
attach(ToothGrowth)
table(supp,dose)
#双因素方差分析
attach(ToothGrowth)
attach(ToothGrowth,pos=3)
attach(ToothGrowth)
table(supp,dose)
attach(mtcars)
table(mpg,cyl)
aggregate(len,by=list(mpg,cyl),FUN=mean)
#多元方差分析
library(MASS)
attach(UScereal)
y<-cbind(calories,fat,sugars)
aggregate(y,by=list(shelf),FUN=mean)
cov(y)
fit<-manova(y~shelf)
summary(fit)
summary.aov(fit)
#检验多元正态性
ceter<-colMeans(y)
n<-nrow(y)
p<-ncol(y)
cov<-cov(y)
d<-mahalanobis(y,center,cov)
d<-mahalanobis(y,ceter,cov)
coord<-qqplot(qchisq(ppoints(n),df=p),d,main="QQ Plot Assessing Multivariate Normality",ylab="Mahalanobis D2")
abline(a=0,b=1)
identify(coord$x,coord$y,labels=row.names(UScereal))
#检验多元离群点
library(mvoutlier)
install.packages("mvoutlier")
library(mvoutlier)
outliers<-aq.plot(y)
outliers
#稳健多元方差分析
library(rrcov)
Wilks.test(y,shelf,method="mcd")
save.image()
savehistory()
#用回归来做ANOVA
library(multcomp)
levels(cholesterol$trt)
fit.aov<-aov(response~trt,data=cholesterol)
summary(fit.aov)
fit.lm<-lm(response~trt,data=cholesterol)
summary(fit.lm)
contrasts(cholesterol$trt)
save.image()
savehistory()
q()
